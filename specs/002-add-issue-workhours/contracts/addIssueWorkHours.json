{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "title": "AddIssueWorkHours MCP Tool Contract",
  "description": "MCP tool contract for adding work hour records to HuaweiCloud ProjectMan issues",
  "type": "object",
  "properties": {
    "tool": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "const": "addIssueWorkHours"
        },
        "title": {
          "type": "string",
          "const": "Add Issue Work Hours"
        },
        "description": {
          "type": "string",
          "const": "Add work hour record to a HuaweiCloud ProjectMan issue"
        },
        "inputSchema": {
          "$ref": "#/definitions/AddIssueWorkHoursInput"
        }
      },
      "required": ["name", "title", "description", "inputSchema"]
    },
    "response": {
      "type": "object",
      "properties": {
        "content": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["text"]
              },
              "text": {
                "type": "string",
                "description": "JSON stringified response from ProjectMan SDK on success, or error message on failure"
              }
            },
            "required": ["type", "text"]
          }
        },
        "isError": {
          "type": "boolean",
          "description": "True if the operation failed"
        }
      },
      "required": ["content"]
    }
  },
  "definitions": {
    "AddIssueWorkHoursInput": {
      "type": "object",
      "properties": {
        "issueId": {
          "type": "integer",
          "minimum": 1,
          "description": "The ID of the issue to add work hours to"
        },
        "workHoursTypeId": {
          "type": "integer",
          "minimum": 21,
          "maximum": 34,
          "description": "Type of work performed. Valid values: 21(研发设计), 22(后端开发), 23(前端开发Web), 24(前端开发小程序), 25(前端开发App), 26(测试验证), 27(缺陷修复), 28(UI设计), 29(会议), 30(公共事务), 31(培训), 32(研究), 33(其它), 34(调休请假)"
        },
        "workHours": {
          "type": "number",
          "exclusiveMinimum": 0,
          "description": "Number of hours worked (must be positive, can include decimals like 0.5)"
        },
        "startDate": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "Start date of the work period in YYYY-MM-DD format",
          "examples": ["2025-11-08", "2025-01-15"]
        },
        "dueDate": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "End date of the work period in YYYY-MM-DD format (must be >= startDate)",
          "examples": ["2025-11-10", "2025-01-20"]
        }
      },
      "required": ["issueId", "workHoursTypeId", "workHours", "startDate", "dueDate"],
      "additionalProperties": false
    },
    "WorkHourTypes": {
      "type": "object",
      "description": "Predefined work hour types from HuaweiCloud ProjectMan",
      "properties": {
        "21": { "const": "研发设计" },
        "22": { "const": "后端开发" },
        "23": { "const": "前端开发(Web)" },
        "24": { "const": "前端开发(小程序)" },
        "25": { "const": "前端开发(App)" },
        "26": { "const": "测试验证" },
        "27": { "const": "缺陷修复" },
        "28": { "const": "UI设计" },
        "29": { "const": "会议" },
        "30": { "const": "公共事务" },
        "31": { "const": "培训" },
        "32": { "const": "研究" },
        "33": { "const": "其它" },
        "34": { "const": "调休请假" }
      }
    }
  },
  "examples": [
    {
      "description": "Add 2.5 hours of backend development work",
      "request": {
        "issueId": 12345,
        "workHoursTypeId": 22,
        "workHours": 2.5,
        "startDate": "2025-11-08",
        "dueDate": "2025-11-10"
      },
      "response": {
        "content": [
          {
            "type": "text",
            "text": "{\"workHourId\":\"abc123\",\"issueId\":12345,\"workHours\":2.5,\"workHoursTypeId\":22}"
          }
        ]
      }
    },
    {
      "description": "Validation error: start date after due date",
      "request": {
        "issueId": 12345,
        "workHoursTypeId": 22,
        "workHours": 2.5,
        "startDate": "2025-11-10",
        "dueDate": "2025-11-08"
      },
      "error": "Start date must not be after due date"
    },
    {
      "description": "Validation error: invalid work hour type",
      "request": {
        "issueId": 12345,
        "workHoursTypeId": 99,
        "workHours": 2.5,
        "startDate": "2025-11-08",
        "dueDate": "2025-11-10"
      },
      "error": "Work hour type ID must be between 21 and 34"
    },
    {
      "description": "API error: issue not found",
      "request": {
        "issueId": 99999999,
        "workHoursTypeId": 22,
        "workHours": 2.5,
        "startDate": "2025-11-08",
        "dueDate": "2025-11-10"
      },
      "response": {
        "content": [
          {
            "type": "text",
            "text": "Error adding work hours: Issue not found"
          }
        ],
        "isError": true
      }
    }
  ]
}
